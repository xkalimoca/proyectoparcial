var users = [
    {
        "manzana": 4,
        "villa": 1,
        "cedula": "1303753618",
        "nombre": "Pablo" ,
        "apellido": "Abda",
        "telefono": "0910957825",
        "correo_electronico": "pabda@hotmail.com",
        "fechainicio": "12/12/2022"
    },
    {
        "manzana": 4,
        "villa": 2,
        "cedula": "1706172648",
        "nombre": "Narcisa",
        "apellido": "Abata",
        "telefono": "0922667825",
        "correo_electronico": "nabata@hotmail.com",
        "fechainicio": "03/02/2020"
    },
    {
        "manzana": 4,
        "villa": 3,
        "cedula": "0100967652",
        "nombre": "Carlos",
        "apellido": " Abril",
        "telefono": "0978626359",
        "correo_electronico": "cabril@hotmail.com",
        "fechainicio": "22/06/2022"
    },
    {
        "manzana": 4,
        "villa": 4,
        "cedula": "1103037048",
        "nombre": "Sonia",
        "apellido": "Castillo",
        "telefono": "0915364427",
        "correo_electronico": "scastillo@hotmail.com",
        "fechainicio": "12/08/2021"
    },
    {
        "manzana": 4,
        "villa": 5,
        "cedula": "0104292461",
        "nombre": "Sandra ",
        "apellido": "Alvarado",
        "telefono": "0708523621",
        "correo_electronico": "salvarado@hotmail.com",
        "fechainicio": "14/01/2020"
    },
    {
        "manzana": 4,
        "villa": 6,
        "cedula": "0102599305",
        "nombre": "Lucia",
        "apellido": "Cajamarca",
        "telefono": "0910458788",
        "correo_electronico": "lcajamarca@hotmail.com",
        "fechainicio": "22/09/2022"
    },
    {
        "manzana": 2,
        "villa": 1,
        "cedula": " 0102918901",
        "nombre": "Jannet",
        "apellido": "Cordero",
        "telefono": "0809663529",
        "correo_electronico": "jcordero@hotmail.com",
        "fechainicio": "07/02/2022"
    },
    {
        "manzana": 2,
        "villa": 2,
        "cedula": "1307871861",
        "nombre": "Ingrid",
        "apellido": "Mera",
        "telefono": "0996758125",
        "correo_electronico": "imera@hotmail.com",
        "fechainicio": "16/06/2022"
    },
    {
        "manzana": 2,
        "villa": 3,
        "cedula": "0904906716",
        "nombre": "Victor",
        "apellido": "Fernandez",
        "telefono": "0978562537",
        "correo_electronico": "vfernandez@hotmail.com",
        "fechainicio": "28/04/2020"
    },
    {
        "manzana": 2,
        "villa": 4,
        "cedula": "1309788162",
        "nombre": "Genny",
        "apellido": "Guanoluiza",
        "telefono": "0968772865",
        "correo_electronico": "gguanoluiza@hotmail.com",
        "fechainicio": "13/07/2021"
    },
    {
        "manzana": 2,
        "villa": 5,
        "cedula": "0703157958",
        "nombre": "Pablo",
        "apellido": "Loaiza",
        "telefono": "0898785236",
        "correo_electronico": "ploaiza@hotmail.com",
        "fechainicio": "30/11/2020"
    },
    {
        "manzana": 3,
        "villa": 1,
        "cedula": "1001236379",
        "nombre": "Leonardo",
        "apellido": "Narvaez",
        "telefono": "0989924461",
        "correo_electronico": "lnarvaez@hotmail.com",
        "fechainicio": "28/07/2021"
    },
    {
        "manzana": 3,
        "villa": 2,
        "cedula": " 1102922588",
        "nombre": "Roy",
        "apellido": "Poma",
        "telefono": "0978985929",
        "correo_electronico": "rpoma@hotmail.com",
        "fechainicio": "11/09/2020"
    },
    {
        "manzana": 3,
        "villa": 3,
        "cedula": "1307567758",
        "nombre": "Laura",
        "apellido": "Sabando",
        "telefono": "0925846825",
        "correo_electronico": "lsabando@hotmail.com",
        "fechainicio": "01/02/2022"
    },
    {
        "manzana": 3,
        "villa": 4,
        "cedula": "1306443910",
        "nombre": "Mery",
        "apellido": "Segovia",
        "telefono": "0922657489",
        "correo_electronico": "msegovia@hotmail.com",
        "fechainicio": "16/06/2022"
    },
    {
        "manzana": 5,
        "villa": 1,
        "cedula": "0801743808",
        "nombre": "Guillermo",
        "apellido": "Valarezo",
        "telefono": "0998963641",
        "correo_electronico": "gvalarezo@hotmail.com",
        "fechainicio": "23/05/2022"
    },
    {
        "manzana": 5,
        "villa": 2,
        "cedula": " 1801407519",
        "nombre": "Luis",
        "apellido": "Villacis",
        "telefono": "0998878520",
        "correo_electronico": "lvillacis@hotmail.com",
        "fechainicio": "29/07/2021"
    },
    {
        "manzana": 5,
        "villa": 3,
        "cedula": "0102295524",
        "nombre": "Alexandra",
        "apellido": "Novo",
        "telefono": "0981253374",
        "correo_electronico": "anovo@hotmail.com",
        "fechainicio": "25/12/2021"
    },
    {
        "manzana": 5,
        "villa": 4,
        "cedula": "1709088569",
        "nombre": "Hipatia",
        "apellido": "Ortiz",
        "telefono": "0986732215",
        "correo_electronico": "hortiz@hotmail.com",
        "fechainicio": "16/03/2022"
    },
    {
        "manzana": 1,
        "villa": 1,
        "cedula": "0602134769",
        "nombre": "Julio",
        "apellido": "Pe単afiel",
        "telefono": "0785992568",
        "correo_electronico": "jpe単afiel@hotmail.com",
        "fechainicio": "20/08/2021"
    },
    {
        "manzana": 1,
        "villa": 2,
        "cedula": " 0301588406",
        "nombre": "Cecilia",
        "apellido": "Ramirez",
        "telefono": "0758698781",
        "correo_electronico": "cramirez@hotmail.com",
        "fechainicio": "19/04/2022"
    },
    {
        "manzana": 1,
        "villa": 3,
        "cedula": "0801012402",
        "nombre": "Tito",
        "apellido": "Robles",
        "telefono": "0708556947",
        "correo_electronico": "trobles@hotmail.com",
        "fechainicio": "05/05/2022"
    },
    {
        "manzana": 1,
        "villa": 4,
        "cedula": "0907887996",
        "nombre": "Melvin",
        "apellido": "Zamora",
        "telefono": "0876942893",
        "correo_electronico": "mzamora@hotmail.com",
        "fechainicio": "13/03/2022"
    }
]

var pagos = [
    {
        "num_tramite": 1,
        "ano": 2020,
        "mes": 12,
        "fecha_pago": "",
        "valor": 80,
        "estado": "PENDIENTE",
        "evidencia": ""
    },
    {
        "num_tramite": 2,
        "ano": 2020,
        "mes": 11,
        "fecha_pago": "",
        "valor": 90,
        "estado": "PENDIENTE",
        "evidencia": ""
    },
    {
        "num_tramite": 3,
        "ano": 2020,
        "mes": 10,
        "fecha_pago": "15/4/2021",
        "valor": 120,
        "estado": "EN MORA",
        "evidencia": ""
    },
    {
        "num_tramite": 4,
        "ano": 2020,
        "mes": 9,
        "fecha_pago": "10/3/2021",
        "valor": 100,
        "estado": "EN MORA",
        "evidencia": ""
    },

    {
        "num_tramite": 5,
        "ano": 2020,
        "mes": 8,
        "fecha_pago": "10/1/2021",
        "valor": 110,
        "estado": "EN MORA",
        "evidencia": ""
    },
    {
        "num_tramite": 6,
        "ano": 2021,
        "mes": 7,
        "fecha_pago": "10/11/2022",
        "valor": 90,
        "estado": "PAGADA",
        "evidencia": ""
    },
    {
        "num_tramite": 7,
        "ano": 2021,
        "mes": 1,
        "fecha_pago": "20/10/2022",
        "valor": 80,
        "estado": "PAGADA",
        "evidencia": ""
    },
    {
        "num_tramite": 8,
        "ano": 2021,
        "mes": 2,
        "fecha_pago": "15/9/2022",
        "valor": 120,
        "estado": "PAGADA",
        "evidencia": ""
    },
    {
        "num_tramite": 9,
        "ano": 2021,
        "mes": 3,
        "fecha_pago": "7/3/2022",
        "valor": 100,
        "estado": "PAGADA",
        "evidencia": ""
    },
    {
        "num_tramite": 10,
        "ano": 2021,
        "mes": 4,
        "fecha_pago": "12/3/2022",
        "valor": 90,
        "estado": "PAGADA",
        "evidencia": ""
    }
]



function iniciar() {
    var email = document.getElementById("correo").value
    var password = document.getElementById("contrasenia").value

    console.log('Correo', email)
    console.log('Contrasenia', password)

    users.forEach(item => {
        if (item.correo_electronico == email) {
            document.getElementById("alerta").textContent = '';
            document.getElementById("alerta").classList.remove('alert');

            if (item.cedula == password) {
                console.log('Has iniciado sesion')
                localStorage.setItem('users', JSON.stringify(item));
                console.log('Usuario:', item)
                window.location = 'user.html'

            } else {
                document.getElementById("alerta").textContent = 'Contrase単a incorrecta';
                document.getElementById("alerta").classList.add('alert');
                console.log('Contrase単a incorrecta')
            }

        } else {
            document.getElementById("alerta").textContent = 'Usuario no encontrado';
            document.getElementById("alerta").classList.add('alert');
        }
    });
}

function residente() {
    var baseUrl = (window.location).href; 
    var koopId = baseUrl.substring(baseUrl.lastIndexOf('=') + 1);

    console.log(koopId)

    var localStor = localStorage.getItem("users")
    var user = JSON.parse(localStor)

    document.getElementById("nom").textContent = user.nombre;
    document.getElementById("fechadeinicio").textContent = user.fechainicio;

    console.log(user, 'usuario')

    var div = document.getElementById('table');

    for (var i = 0; i < pagos.length; i++) {

        var color 

        if(pagos[i].estado === 'PAGADA'){
            color = 'verde'

        }
        if(pagos[i].estado === 'PENDIENTE'){
            color = 'amarillo'
        }

        if(pagos[i].estado === 'EN MORA'){
            color = 'rojo'
        }

        var row = `<tr >
            <th>${pagos[i].ano}</th>
            <th>${pagos[i].mes}</th>
            <th>${pagos[i].fecha_pago}</th>
            <th>${pagos[i].valor}</th>
            <th><div class=${color}>${pagos[i].estado}</div></th>
            <th><a href='evidencia.html?id=${pagos[i].num_tramite}'><img width='50' src='./images/descarga.png' /></a></th>
        </tr>`

        div.innerHTML += row
        
    }
}

function admin() {
    var baseUrl = (window.location).href; 
    var koopId = baseUrl.substring(baseUrl.lastIndexOf('=') + 1);

    console.log(koopId)

    var localStor = localStorage.getItem("users")
    var users = JSON.parse(localStor)

    document.getElementById("nomb").textContent = users.nombre;
    document.getElementById("fechadeinicio1").textContent = users.fechainicio;

    console.log(users, 'usuario')
    
    var div = document.getElementById('table1');

    for (var i = 0; i < pagos.length; i++) {

        var color 

        if(pagos[i].estado === 'PAGADA'){
            color = 'verde'
        }

        if(pagos[i].estado === 'PENDIENTE'){
            color = 'amarillo'
        }

        if(pagos[i].estado === 'EN MORA'){
            color = 'rojo'
        }

        var row = `<tr >
            <th>${pagos[i].ano}</th>
            <th>${pagos[i].mes}</th>
            <th>${pagos[i].fecha_pago}</th>
            <th>${pagos[i].valor}</th>
            <th><div class=${color}>${pagos[i].estado}</div></th>
            <th><a href='verificacion.html?id=${pagos[i].num_tramite}'><img width='50' src='./images/verificar.png' /></a></th>
            <th><a href='evidencia.html?id=${pagos[i].num_tramite}'><img width='50' src='./images/descarga.png' /></a></th>
        </tr>`

        div.innerHTML += row
        //
    }
}

function evidencia() {
    var baseUrl = (window.location).href; 
    var id = baseUrl.substring(baseUrl.lastIndexOf('=') + 1);
    
    const date = new Date()
    date.setHours(0, 0, 0, 0)

    document.getElementById("fecha").value = date;

    pagos.forEach(item => {
        if (item.num_tramite == id) {
            document.getElementById("numero").value = item.num_tramite;
            let newDate = new Date(`${item.ano}-${item.mes}-01"`)
            if(date > newDate){
            }
        }
    });
   
}
function fecha_pago() {
    var baseUrl = (window.location).href; 
    var id = baseUrl.substring(baseUrl.lastIndexOf('=') + 1);
    
    const date = new Date()
    date.setHours(0, 0, 0, 0)

    document.getElementById("fecha").value = date;
    
    pagos.forEach(item => {

        if (item.num_tramite == id) {
            document.getElementById("numero").value = item.num_tramite;
            let newDate = new Date(`${item.ano}-${item.mes}-01"`)
           
            if(date > newDate){
                console.log('')
            }
            
            console.log(date, '--', newDate)
           
        }
    });
   
}

function verificar() {
    var baseUrl = (window.location).href; 
    var id = baseUrl.substring(baseUrl.lastIndexOf('=') + 1);
    
    const date = new Date()
    date.setHours(0, 0, 0, 0)

    document.getElementById("fecha").value = date;
    
    pagos.forEach(item => {
        if (item.num_tramite == id) {
            document.getElementById("numero").value = item.num_tramite;
            let newDate = new Date(`${item.ano}-${item.mes}-01"`)
            if(date > newDate){
            }
        }
    });
   
}

function cancelar(){
    window.location = 'index.html'
}

function adminview(){
    window.location = './admin/index.html'
}

function cancelarverificacion(){
    window.location = 'admin.html'
}

function cancelarevidencia(){
    window.location = 'user.html'
}

function retroceder(){
    window.location = 'user.html'
}




